{
  "permissions": {
    "allow": [
      "Bash(npm run build:*)",
      "Bash(npm ls:*)",
      "Bash(npm uninstall:*)",
      "Bash(npm install:*)",
      "Bash(npx prisma migrate dev:*)",
      "Bash(npm view:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat: Critical security fixes - Real Stripe checkout integration\n\nBREAKING: Orders now require actual payment via Stripe\n\nSecurity fixes (Phase 1):\n- Implement real Stripe Checkout Session integration\n- Add server-side price calculation from database\n- Implement webhook idempotency to prevent duplicate orders\n- Add inventory validation to cart operations\n- Add comprehensive structured logging\n\nCritical issues resolved:\n1. Checkout now creates Stripe session instead of fake orders\n2. Prices calculated server-side (cannot be manipulated)\n3. Webhooks are idempotent (safe for Stripe retries)\n4. Cart validates inventory before adding items\n5. Full audit trail with structured logging\n\nImpact:\n- Revenue protection: Real payment processing\n- Financial security: Server-verified pricing\n- Data integrity: No duplicate orders\n- Business logic: Inventory validation\n- Observability: Structured logs for debugging\n\nFiles changed:\n- app/api/checkout/route.ts: Real Stripe integration\n- app/api/webhook/route.ts: Idempotency + logging\n- app/api/cart/route.ts: Inventory validation\n- lib/logger.ts: New structured logging system\n\nRefs: PRODUCTION_READINESS.md issues #1, #2, #3, #4\n\nðŸ¤– Generated with Claude Code (claude.com/claude-code)\n\nCo-Authored-By: Security Guardian <security@linkflame.ai>\nCo-Authored-By: Feature Engineer <features@linkflame.ai>\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git commit:*)",
      "Bash(git checkout:*)",
      "Bash(npx prisma:*)",
      "Bash(DATABASE_URL=\"file:./dev.db\" npx prisma db push:*)",
      "Bash(DATABASE_URL=\"file:./prisma/dev.db\" npx prisma generate:*)",
      "Bash(DATABASE_URL=\"file:./prisma/dev.db\" npx prisma migrate dev:*)",
      "Bash(DATABASE_URL=\"file:./dev.db\" npx prisma migrate:*)",
      "Bash(DATABASE_URL=\"file:./prisma/dev.db\" NEXTAUTH_SECRET=\"test_secret_for_migration_only_32chars\" npx prisma generate:*)",
      "Bash(git restore:*)",
      "Bash(DATABASE_URL=\"file:./prisma/dev.db\" npx prisma db push:*)",
      "Bash(DATABASE_URL=\"file:./prisma/dev.db\" npx prisma db seed:*)",
      "Bash(export DATABASE_URL=\"file:./dev.db\")",
      "Bash(sqlite3:*)",
      "Bash(DATABASE_URL=\"file:./dev.db\" npx prisma generate:*)",
      "Bash(npx vitest:*)",
      "Bash(git rebase:*)",
      "Bash(GIT_EDITOR=true git rebase:*)"
    ],
    "deny": [],
    "ask": []
  }
}
